<% content_for :title, @note.content.lines.first&.strip&.truncate(60) %>

<% content_for :head do %>
<style>
  .note-body { line-height: 1.75; color: #111; }
  .note-body h1, .note-body h2, .note-body h3,
  .note-body h4, .note-body h5, .note-body h6 {
    font-weight: 700; line-height: 1.3; margin: 1.6em 0 0.4em;
  }
  .note-body h1:first-child, .note-body h2:first-child { margin-top: 0; }
  .note-body h1 { font-size: 1.75em; }
  .note-body h2 { font-size: 1.35em; }
  .note-body h3 { font-size: 1.1em; }
  .note-body p  { margin: 0.9em 0; }
  .note-body a  { text-decoration: underline; }
  .note-body a:hover { opacity: 0.6; }
  .note-body strong { font-weight: 700; }
  .note-body em { font-style: italic; }
  .note-body del { opacity: 0.4; }
  .note-body ul, .note-body ol { margin: 0.8em 0; padding-left: 1.6em; }
  .note-body li { margin: 0.3em 0; }
  .note-body code {
    font-family: 'Cascadia Code', 'Fira Code', monospace;
    font-size: 0.875em;
    background: #f3f4f6;
    padding: 2px 5px;
  }
  .note-body pre {
    background: #f3f4f6;
    padding: 1rem 1.25rem;
    overflow-x: auto;
    margin: 1em 0;
    font-size: 0.875em;
    line-height: 1.6;
  }
  .note-body pre code { background: none; padding: 0; }
  .note-body blockquote {
    border-left: 2px solid #000;
    padding-left: 1rem;
    margin: 1em 0;
    color: #555;
  }
  .note-body table { border-collapse: collapse; width: 100%; margin: 1em 0; font-size: 0.9em; }
  .note-body th, .note-body td { border: 1px solid #e5e7eb; padding: 8px 12px; text-align: left; }
  .note-body th { font-weight: 700; background: #f9fafb; }
  .note-body hr { border: none; border-top: 1px solid #e5e7eb; margin: 2em 0; }
  .note-body img { max-width: 100%; }
</style>
<% end %>

<div class="max-w-2xl mx-auto">

  <div class="flex items-center justify-between mb-8 text-sm">
    <%= link_to "â† Notes", notes_path, class: "hover:underline" %>
    <div class="flex items-center gap-4">
      <button data-controller="clipboard" data-clipboard-content-value="<%= h @note.content %>"
              data-action="click->clipboard#copy"
              class="hover:opacity-50 transition-opacity cursor-pointer bg-transparent border-0 p-0" title="Copy">
        <span data-clipboard-target="icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
        </span>
      </button>
      <%= link_to edit_note_path(@note, mode: "easymde"), class: "hover:opacity-50 transition-opacity text-xs text-gray-400", title: "EasyMDE" do %>EasyMDE<% end %>
      <%= link_to edit_note_path(@note), class: "hover:opacity-50 transition-opacity", title: "Edit" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
      <% end %>
      <%= button_to note_path(@note), method: :delete,
          class: "hover:opacity-50 transition-opacity bg-transparent border-0 cursor-pointer p-0",
          title: "Delete",
          data: { turbo_method: :delete, turbo_confirm: "Delete?" } do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/></svg>
      <% end %>
    </div>
  </div>

  <div class="note-body">
    <%= markdown(@note.content) %>
  </div>

  <p class="text-xs text-gray-400 mt-10"><%= @note.updated_at.strftime("%B %d, %Y") %></p>

</div>
